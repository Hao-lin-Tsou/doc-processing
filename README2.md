# Word信息卡处理工具

一个用于从Word文档中提取信息卡数据和图片的Python工具，专门用于处理深圳市探地雷达检测地面坍塌隐患信息卡。

## 功能特性

- 📄 **自动解析Word文档中的信息卡表格**
- 📊 **导出数据到Excel文件**
- 🖼️ **批量提取并保存图片到分类文件夹**
- 📋 **生成详细的处理日志报告**
- ✅ **数据完整性检查**
- 📈 **处理统计和完整率计算**

## 安装要求

- Python 3.7+
- 依赖包见 `requirements.txt`

## 安装步骤

1. 克隆项目到本地：
```bash
git clone https://github.com/yourusername/word-info-card-processor.git
cd word-info-card-processor
```

2. 安装依赖：
```bash
pip install -r requirements.txt
```

## 使用方法

### 基础使用

1. 将你的Word文档放在项目目录下
2. 修改 `main.py` 中的文件路径：

```python
def main():
    # 修改这些路径
    word_file_path = "your_document.docx"  # Word文件路径
    output_excel_path = "信息卡数据.xlsx"    # Excel输出路径
    images_folder_path = "信息卡图片"         # 图片文件夹路径
    log_file_path = "处理日志.txt"           # 日志文件路径
```

3. 运行程序：
```bash
python main.py
```

### 输出说明

程序运行后会生成以下文件：

- **Excel文件** (`信息卡数据.xlsx`): 包含所有信息卡的结构化数据
- **图片文件夹** (`信息卡图片/`): 按信息卡编号分类保存的图片
- **日志文件** (`处理日志.txt`): 详细的处理报告和完整性检查结果

### 支持的字段

程序可以提取以下信息卡字段：

| 字段名 | 说明 |
|--------|------|
| 编号 | 信息卡编号 |
| 天气 | 检测时天气情况 |
| 路面材质 | 道路材质类型 |
| 长(m) | 长度尺寸 |
| 宽(m) | 宽度尺寸 |
| 埋深(m) | 埋设深度 |
| 净深(m) | 净空深度 |
| 面积(m²) | 面积数据 |
| 体积(m³) | 体积数据 |
| 位置描述 | 具体位置说明 |
| 验证时间 | 验证检测时间 |
| 隐患等级 | 风险等级评估 |
| 隐患类型 | 隐患分类 |
| 雷达型号 | 使用的雷达设备型号 |
| 天线主频（MHz） | 雷达天线频率 |
| 经纬度坐标E | 东经坐标 |
| 经纬度坐标N | 北纬坐标 |
| 成因初步分析 | 问题成因分析 |
| 初步处置建议 | 处理建议 |
| 钻探及其他验证结果 | 验证结果 |

## 日志报告示例

```
============================================================
信息卡处理日志报告
生成时间: 2024-01-15 14:30:25
============================================================

编号：SZ001信息卡
状态：完整输出
----------------------------------------

编号：SZ002信息卡
状态：存在缺失
缺失字段：天气, 路面材质
图片未保存：雷达检测图
----------------------------------------

============================================================
处理总结
============================================================
总信息卡数量：10
完整输出：8张
存在缺失：2张
完整率：80.00%
============================================================
```

## 自定义配置

如果你的信息卡格式有所不同，可以在 `parse_info_card_from_table` 函数中添加新的字段识别逻辑：

```python
elif '你的字段名' in cell_text and cell_idx + 1 < len(row.cells):
    info_card['你的字段名'] = extract_text_from_table_cell(row.cells[cell_idx + 1])
```

## 常见问题

### Q: 程序运行时提示缺少依赖包怎么办？
A: 运行 `pip install -r requirements.txt` 安装所有依赖包。

### Q: Excel文件无法生成怎么办？
A: 程序会自动尝试使用 openpyxl 或 xlsxwriter 引擎，如果都不可用会保存为CSV格式。

### Q: 图片提取失败怎么办？
A: 检查Word文档中的图片格式，程序支持嵌入式图片。日志文件会详细记录失败原因。

### Q: 如何处理不同格式的信息卡？
A: 修改 `parse_info_card_from_table` 函数中的字段识别逻辑，添加你需要的字段。


## 许可证

本项目采用 MIT License 许可证 - 查看 [LICENSE](LICENSE) 文件了解详情。

## 作者

HL
